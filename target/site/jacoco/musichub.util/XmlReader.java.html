<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="fr"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>XmlReader.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">jMusicHubV2</a> &gt; <a href="index.source.html" class="el_package">musichub.util</a> &gt; <span class="el_source">XmlReader.java</span></div><h1>XmlReader.java</h1><pre class="source lang-java linenums">package musichub.util;

import musichub.business.Chanson;
import musichub.business.Genre;
import musichub.business.IJouable;
import musichub.business.LivreAudio;
import musichub.business.Langue;
import musichub.business.Categorie;
import musichub.business.Album;
import musichub.business.Playlist;

import java.util.Collection;
import java.util.Collections;
import java.util.LinkedList;
import java.util.List;
import java.io.File;
import javax.xml.parsers.DocumentBuilderFactory;
import javax.xml.parsers.DocumentBuilder;

import org.w3c.dom.Document;
import org.w3c.dom.NodeList;
import org.w3c.dom.Node;
import org.w3c.dom.Element;

/**
 * classe publique XmlReader qui lie les fichiers XML.
 *
 * les methodes sont publiques et sont expliquées plus tard dans le code.
 * 
 * @author Sarra MADAD, Nour El-Houda LOUATY.
 */


<span class="nc" id="L34">public class XmlReader  {</span>

    //DocumentBuilder dBuilder;

    //public XmlReader() throws Exception {
    //    DocumentBuilderFactory dbFactory = DocumentBuilderFactory.newInstance();
    //    this.dBuilder = dbFactory.newDocumentBuilder();
    //} --&gt; c'est le constructeur, pas obligatoire car fait dans les getChanson etc

 /**
 * méthode publique extractChanson qui extrait les chansons des fichiers XML en les prenant en paramètre en tant que listes de noeuds et les transforme en liste de chansons.
 * @return elle retourne donc une liste de chansons -chansons que l'on aura construit avec le constructeur et les éléments récupérés par TagName- et les trie avec sort().
 * 
 */       
    public List&lt;Chanson&gt; extractChanson(NodeList nList) {
        String id;
        String titre;
        String duree;
        String artiste;
        String contenu;
        String genre;
        String date;
        Chanson chanson;
<span class="nc" id="L57">        List&lt;Chanson&gt; chansons = new LinkedList&lt;Chanson&gt;();</span>

        //on boucle pour toute la taille du fichier xml donc la liste de noeuds d'information
<span class="nc bnc" id="L60" title="All 2 branches missed.">        for (int temp = 0; temp &lt; nList.getLength(); temp++) {</span>
<span class="nc" id="L61">            Node nNode = nList.item(temp);</span>
<span class="nc" id="L62">            Element eElement = (Element) nNode;</span>

<span class="nc" id="L64">            id = eElement.getElementsByTagName(&quot;id&quot;).item(0).getTextContent();</span>
<span class="nc" id="L65">            titre = eElement.getElementsByTagName(&quot;titre&quot;).item(0).getTextContent();</span>
<span class="nc" id="L66">            duree = eElement.getElementsByTagName(&quot;duree&quot;).item(0).getTextContent();</span>
<span class="nc" id="L67">            artiste = eElement.getElementsByTagName(&quot;artiste&quot;).item(0).getTextContent();</span>
<span class="nc" id="L68">            contenu = eElement.getElementsByTagName(&quot;contenu&quot;).item(0).getTextContent();</span>
<span class="nc" id="L69">            genre = eElement.getElementsByTagName(&quot;genre&quot;).item(0).getTextContent();</span>
<span class="nc" id="L70">            date = eElement.getElementsByTagName(&quot;date&quot;).item(0).getTextContent();</span>

<span class="nc" id="L72">            chanson = new Chanson(Integer.parseInt(id), titre, Integer.parseInt(duree), artiste, contenu, Genre.valueOf(genre), date);</span>
<span class="nc" id="L73">            chansons.add(chanson);</span>
        }
<span class="nc" id="L75">        Collections.sort(chansons);</span>
<span class="nc" id="L76">        return chansons;</span>
    }

 /**
 * méthode publique extractLivreAudio qui extrait les livres audio des fichiers XML en les prenant en paramètre en tant que listes de noeuds et les transforme en liste de livres audio.
 * @return elle retourne donc une liste de livres audio -livres que l'on aura construit avec le constructeur et les éléments récupérés par TagName- et les trie avec sort().
 * 
 */  
    public List&lt;LivreAudio&gt; extractLivreAudio(NodeList nList) {
        String id;
        String titre;
        String duree;
        String auteur;
        String contenu;
        String langue;
        String categorie;
        LivreAudio livreaudio;
<span class="nc" id="L93">        List&lt;LivreAudio&gt; livresaudio = new LinkedList&lt;LivreAudio&gt;();</span>

        //on boucle pour toute la taille du fichier xml donc la liste de noeuds d'information
<span class="nc bnc" id="L96" title="All 2 branches missed.">        for (int temp = 0; temp &lt; nList.getLength(); temp++) {</span>
<span class="nc" id="L97">            Node nNode = nList.item(temp);</span>

<span class="nc bnc" id="L99" title="All 2 branches missed.">            if (nNode.getNodeType() == Node.ELEMENT_NODE) {</span>
<span class="nc" id="L100">                Element eElement = (Element) nNode;</span>
<span class="nc" id="L101">                id = eElement.getElementsByTagName(&quot;id&quot;).item(0).getTextContent();</span>
<span class="nc" id="L102">                titre = eElement.getElementsByTagName(&quot;titre&quot;).item(0).getTextContent();</span>
<span class="nc" id="L103">                duree = eElement.getElementsByTagName(&quot;duree&quot;).item(0).getTextContent();</span>
<span class="nc" id="L104">                auteur = eElement.getElementsByTagName(&quot;auteur&quot;).item(0).getTextContent();</span>
<span class="nc" id="L105">                contenu = eElement.getElementsByTagName(&quot;contenu&quot;).item(0).getTextContent();</span>
<span class="nc" id="L106">                langue = eElement.getElementsByTagName(&quot;langue&quot;).item(0).getTextContent();</span>
<span class="nc" id="L107">                categorie = eElement.getElementsByTagName(&quot;categorie&quot;).item(0).getTextContent();</span>

<span class="nc" id="L109">                livreaudio = new LivreAudio(Integer.parseInt(id), titre, Integer.parseInt(duree), auteur, contenu, Langue.valueOf(langue), Categorie.valueOf(categorie));</span>
<span class="nc" id="L110">                livresaudio.add(livreaudio);</span>
            }
        }
<span class="nc" id="L113">        Collections.sort(livresaudio);</span>
<span class="nc" id="L114">        return livresaudio;</span>
    }

/**
 * méthode publique getChanson qui permet d'extraire les chansons du fichier elements.xml.
 * Elle fait appel à la méthode extractChansons pour transformer les noeuds d'information du fichier en attribut d'une chanson.
 * @return elle retourne donc une liste de chansons.
 * 
 */     
    public List&lt;Chanson&gt; getChansons() throws Exception {
<span class="nc" id="L124">        List&lt;Chanson&gt; liste = null; //pour que la méthode sort fonctionne on change en List au lieu de Collection&lt;Chanson&gt;, il faut donc changer cela partout !</span>

<span class="nc" id="L126">        File inputFile = new File(&quot;files/elements.xml&quot;);</span>
<span class="nc" id="L127">        DocumentBuilderFactory dbFactory = DocumentBuilderFactory.newInstance();</span>
<span class="nc" id="L128">        DocumentBuilder dBuilder = dbFactory.newDocumentBuilder();</span>
<span class="nc" id="L129">        Document doc = dBuilder.parse(inputFile);</span>
<span class="nc" id="L130">        doc.getDocumentElement().normalize();</span>
<span class="nc" id="L131">        NodeList nList = doc.getElementsByTagName(&quot;Chanson&quot;);</span>
<span class="nc" id="L132">        liste = this.extractChanson(nList);</span>

        //Collections.sort(liste)-&gt; pas besoin car déjà dans le extractChanson
<span class="nc" id="L135">        return liste;   </span>
        
    }

 /**
 * méthode publique getLivreAudio qui permet d'extraire les livres audio du fichier elements.xml.
 * Elle fait appel à la méthode extractLivresAudio pour transformer les noeuds d'information du fichier en attribut d'un livre audio.
 * @return elle retourne donc une liste de livres audio.
 * 
 */      
    public List&lt;LivreAudio&gt; getLivresAudio() throws Exception {
<span class="nc" id="L146">        List&lt;LivreAudio&gt; listelv = null;</span>
 
<span class="nc" id="L148">        File inputFile = new File(&quot;files/elements.xml&quot;);</span>
<span class="nc" id="L149">        DocumentBuilderFactory dbFactory = DocumentBuilderFactory.newInstance();</span>
<span class="nc" id="L150">        DocumentBuilder dBuilder = dbFactory.newDocumentBuilder();</span>
<span class="nc" id="L151">        Document doc = dBuilder.parse(inputFile);</span>
<span class="nc" id="L152">        doc.getDocumentElement().normalize();</span>
<span class="nc" id="L153">        NodeList nList = doc.getElementsByTagName(&quot;LivreAudio&quot;);</span>
<span class="nc" id="L154">        listelv = this.extractLivreAudio(nList);</span>

        //Collections.sort(listelv)-&gt; pas besoin car déjà dans le extractLivreAudio
<span class="nc" id="L157">        return listelv;</span>
    }

 /**
 * méthode publique getAlbums qui permet d'extraire les albums du fichier albums.xml.
 * Elle transforme les noeuds d'information du fichier en attribut d'un album.
 * @return elle retourne donc une liste d'albums et les trie avec sort().
 * 
 */ 
    public List&lt;Album&gt; getAlbums() throws Exception {
        String id;
        String titre;
        String duree;
        String artiste;
        String date;
<span class="nc" id="L172">        List&lt;Chanson&gt; listeChansons = new LinkedList&lt;Chanson&gt;();</span>
<span class="nc" id="L173">        List&lt;Album&gt; listeAlbums = new LinkedList&lt;Album&gt;();</span>

        
<span class="nc" id="L176">            File inputFile = new File(&quot;files/albums.xml&quot;);</span>
<span class="nc" id="L177">            DocumentBuilderFactory dbFactory = DocumentBuilderFactory.newInstance();</span>
<span class="nc" id="L178">            DocumentBuilder dBuilder = dbFactory.newDocumentBuilder();</span>
<span class="nc" id="L179">            Document doc = dBuilder.parse(inputFile);</span>
<span class="nc" id="L180">            doc.getDocumentElement().normalize();</span>
<span class="nc" id="L181">            NodeList nList = doc.getElementsByTagName(&quot;Album&quot;);</span>

            //on boucle pour toute la taille du fichier xml donc la liste de noeuds d'information
<span class="nc bnc" id="L184" title="All 2 branches missed.">            for (int temp = 0; temp &lt; nList.getLength(); temp++) {</span>
<span class="nc" id="L185">                Node nNode = nList.item(temp);</span>

<span class="nc bnc" id="L187" title="All 2 branches missed.">                if (nNode.getNodeType() == Node.ELEMENT_NODE) {</span>
<span class="nc" id="L188">                    Element eElement = (Element) nNode;</span>
<span class="nc" id="L189">                    id = eElement.getElementsByTagName(&quot;id&quot;).item(0).getTextContent();</span>
<span class="nc" id="L190">                    titre = eElement.getElementsByTagName(&quot;titre&quot;).item(0).getTextContent();</span>
<span class="nc" id="L191">                    duree = eElement.getElementsByTagName(&quot;duree&quot;).item(0).getTextContent();</span>
<span class="nc" id="L192">                    NodeList nListeChanson = eElement.getElementsByTagName(&quot;Chanson&quot;);</span>
<span class="nc" id="L193">                    listeChansons = this.extractChanson(nListeChanson);</span>
<span class="nc" id="L194">                    artiste = eElement.getElementsByTagName(&quot;artiste&quot;).item(0).getTextContent();</span>
<span class="nc" id="L195">                    date = eElement.getElementsByTagName(&quot;date&quot;).item(0).getTextContent();</span>

<span class="nc" id="L197">                    Album album = new Album(Integer.parseInt(id), titre, Integer.parseInt(duree), listeChansons,</span>
                            artiste, date);
<span class="nc" id="L199">                    listeAlbums.add(album);</span>

                }
            }
<span class="nc" id="L203">        Collections.sort(listeAlbums);</span>
<span class="nc" id="L204">        return listeAlbums;</span>
    }

/**
 * méthode publique getPlaylists qui permet d'extraire les playlists du fichier playlists.xml.
 * Elle transforme les noeuds d'information du fichier en attribut d'une playlist.
 * @return elle retourne donc une liste de playlists et les trie avec sort().
 * 
 */    
    public List&lt;Playlist&gt; getPlaylists() throws Exception {
        String id;
        String nom;
<span class="nc" id="L216">        List&lt;Chanson&gt; chansons = null;</span>
<span class="nc" id="L217">        List&lt;LivreAudio&gt; livresaudio = null;</span>
<span class="nc" id="L218">        List&lt;Playlist&gt; listePlaylists = new LinkedList&lt;Playlist&gt;();</span>

<span class="nc" id="L220">        File inputFile = new File(&quot;files/playlists.xml&quot;);</span>
<span class="nc" id="L221">        DocumentBuilderFactory dbFactory = DocumentBuilderFactory.newInstance();</span>
<span class="nc" id="L222">        DocumentBuilder dBuilder = dbFactory.newDocumentBuilder();</span>
<span class="nc" id="L223">        Document doc = dBuilder.parse(inputFile);</span>
<span class="nc" id="L224">        doc.getDocumentElement().normalize();</span>
<span class="nc" id="L225">        NodeList nList = doc.getElementsByTagName(&quot;Playlist&quot;);</span>

        //on boucle pour toute la taille du fichier xml donc la liste de noeuds d'information
<span class="nc bnc" id="L228" title="All 2 branches missed.">        for (int temp = 0; temp &lt; nList.getLength(); temp++) {</span>
<span class="nc" id="L229">            Node nNode = nList.item(temp);</span>
<span class="nc bnc" id="L230" title="All 2 branches missed.">                if (nNode.getNodeType() == Node.ELEMENT_NODE) {</span>
<span class="nc" id="L231">                    Element eElement = (Element) nNode;</span>
<span class="nc" id="L232">                    id = eElement.getElementsByTagName(&quot;id&quot;).item(0).getTextContent();</span>
<span class="nc" id="L233">                    nom = eElement.getElementsByTagName(&quot;nom&quot;).item(0).getTextContent();</span>
<span class="nc" id="L234">                    chansons = this.extractChanson(eElement.getElementsByTagName(&quot;Chanson&quot;));</span>
<span class="nc" id="L235">                    livresaudio = this.extractLivreAudio(eElement.getElementsByTagName(&quot;LivreAudio&quot;));</span>
                    
<span class="nc" id="L237">                    Collection&lt;IJouable&gt; listeElements = new LinkedList&lt;IJouable&gt;();//on garde IJouable car on veut y ajouter des chansons ET des lv </span>
<span class="nc" id="L238">                    listeElements.addAll(chansons);</span>
<span class="nc" id="L239">                    listeElements.addAll(livresaudio);</span>

<span class="nc" id="L241">                    Playlist playlist = new Playlist(Integer.parseInt(id), nom, listeElements);</span>
<span class="nc" id="L242">                    listePlaylists.add(playlist);</span>
                }
            }
<span class="nc" id="L245">        Collections.sort(listePlaylists);</span>
<span class="nc" id="L246">        return listePlaylists;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.2.201808211720</span></div></body></html>